{
  "hash": "0ea48767dd9716025005edb7e86ff4f8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 2\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n#Parameters\n\nN <- 5000        #Default size of the population\n\nMU <- 100        #Default mean of the population\n\nsigma <- MU / 5  #Standard deviation is 1/5 of the mean\n\n#Generate the population\n\npopulation <- rnorm(N, mean = MU, sd = sigma)\npopulation[population <= 0] <- 1\n\n#Create gini function\n\ngini <- function(y) {\n  y <- sort(y)     #Sort pop by wealth in asending order \n  n <- length(y)   #Number of people\n  numer <- 2 * sum((1:n) * y)  #Numerator sum of sorted values weighted by list pos\n  denom <- n * sum(y)  #Denominator total wealth of pop\n    return((numer / denom) - (n + 1) / n) #Compute gini coeffi\n}\n\n# Print initial Gini coefficient\ncat(\"Initial Gini coefficient:\", gini(population), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInitial Gini coefficient: 0.1121553 \n```\n\n\n:::\n\n```{.r .cell-code}\n#Create hist of pop\n\nlibrary(ggplot2)\nlibrary(ggplot2)\nhist_pop <- function(population, label='Population') {\n  gini_value <- round(gini(population), 2)\n  label <- paste(label, \"- Gini =\", gini_value)\n  \n  p <- ggplot(data.frame(population), aes(x = population)) +\n    geom_histogram(bins = 30, fill = \"blue\", color = \"black\", alpha = 0.5) +\n    labs(title = label, x = \"Wealth\", y = \"Count\") +\n    theme_minimal() +\n    theme(panel.grid.major = element_line(colour = \"grey\"))\n  \n  print(p)  \n}\n\nhist_pop(population)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Transaction: Randomly split the pot between two actors\nrandom_split <- function(A, B) {\n  pot <- A + B\n  if (A <= 0 && B <= 0) return(c(0, 0))\n  share <- runif(1, 0, pot)\n  return(c(share, pot - share))\n}\n\n# Randomly select two actors\nanyone <- function(N) sample(1:N, 2)\n\n# Simulation step: Perform one transaction between two random actors\nstep_function <- function(population) {\n  indices <- anyone(length(population))\n  population[indices] <- random_split(population[indices[1]], population[indices[2]])\n  return(population)\n}\n\n# Simulate over T steps\nsimulate <- function(population, T) {\n  for (t in 1:T) {\n    population <- step_function(population)\n  }\n  return(population)\n}\n\n# Run the simulation and visualize the results\nT <- 1000  # Number of steps\nfinal_population <- simulate(population, T)\n\n# Plot final population distribution\nhist_pop(final_population, \"Final Population\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Display final Gini coefficient\ncat(\"Final Gini coefficient:\", gini(final_population), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFinal Gini coefficient: 0.2120456 \n```\n\n\n:::\n:::\n\n\n\n\n------------------------------------------------------------------------\n\n``` R\n```\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}